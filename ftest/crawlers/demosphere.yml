---
spiders:
  archive:
    start_url: https://paris.demosphere.net/?selectStartTime=1172703601&endTime=1175378401&limit=1000&showArchiveLinks=1
    next:
      scraper:
        sel: '#archive > table td > a'
        fields:
          url:
            attr: href
            eval: value.replace('&limit=1000', '')
          spider:
            constant: month
    max_depth: 0
  month:
    next:
      scraper:
        iterator: .dcal > .day a[href^='/rv/']
        fields:
          url:
            attr: href
          spider:
            constant: rv
    max_depth: 1
  rv:
    scrapers:
      rvs:
        fields:
          title:
            sel: title
          url:
            sel: link[rel=canonical]
            attr: href
          date:
            sel: '#dateContents > .date'
            attr: data-val
          time:
            sel: '#dateContents > .time'
            attr: data-val
          themes:
            sel: .topicsList > a
            eval: "'|'.join([e.get_text().strip() for e in elements])"
          comments:
            sel: .actionBoxLinkText
            eval: "re.sub(r'[^0-9]', '', value)"
          parts:
            sel: '#textPart0 .textNav > a'
            eval: len(elements)
            default: 1
          address:
            sel: .address-text > a
            eval: "' ยง '.join([s.strip() for s in value.split('\\n')])"
          coordinates:
            sel: .mapimage-link
            attr: href
            eval: "value.split('place/')[-1].split('/')[0]"
          incomplete:
            sel: .incomplete
            constant: 1
          first:
            sel: .dayrank1
            constant: 1
          second:
            sel: .dayrank2
            constant: 1
